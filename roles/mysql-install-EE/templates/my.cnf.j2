[mysqld]
bind-address=0.0.0.0
socket= {{ socket }}
datadir = {{ datadir }}
lower-case-table-names = 1
innodb-buffer-pool-size = {{ ((mem_total.stdout| int ) * 0.5 ) |int }}M
log-error = {{ error_log }}

# replication
log-bin = {{ binlog_dir }}/{{ hostvars[inventory_hostname]['ansible_nodename'] }}
expire-logs-days = {{ expire_log_days }}
gtid-mode = on 
enforce-gtid-consistency = on 
server-id = {{ hostvars[inventory_hostname]['ansible_default_ipv4']['address'] | regex_replace('([0-9]{1,3}\.){2}([0-9]*)\.([0-9]*)$', '\2\3') }}

[mysql]
socket = {{ socket }}
